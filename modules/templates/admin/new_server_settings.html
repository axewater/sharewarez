{% extends "base.html" %}
{% block content %}

<div class="container">
    <div class="glass-panel">
        <a href="{{ url_for('site.admin_dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
    </div>
</div>


<div class="container-status-page container-settings">
    <div class="card">
        <h2>Manage SharewareZ Settings</h2>

        <div id="settingsSavedNotification" class="alert alert-success" role="alert" style="display: none;">
            Settings saved successfully, Captain!
        </div>
        <div class="settingsform-admin">
            <form id="settingsForm">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h3 class="mb-0">Server Configuration</h3>
                    <button type="submit" class="btn btn-primary">Save Settings</button>
                </div>

                <div class="row">
                    <!-- Column 1: Core Features -->
                    <div class="col-lg-4">
                        <div class="settings-section">
                            <h5 class="section-header">
                                <i class="fa-solid fa-puzzle-piece"></i> Core Features
                            </h5>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="allowUsersToInviteOthers">
                                <label class="form-check-label" for="allowUsersToInviteOthers" data-toggle="tooltip" title="Enables regular users to send invitations to new users.">
                                    Enable User Invite System
                                </label>
                            </div>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="enableServerStatusFeature">
                                <label class="form-check-label" for="enableServerStatusFeature" data-toggle="tooltip" title="Enables the server info button in the admin dashboard. This contains sensitive server information such as API keys!">
                                    Enable Server Info Feature
                                </label>
                            </div>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="enableNewsletterFeature">
                                <label class="form-check-label" for="enableNewsletterFeature" data-toggle="tooltip" title="Enables the newsletter functionality, allowing administrators to send updates and announcements to users.">
                                    Enable Newsletter Feature
                                </label>
                            </div>

                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="enableDeleteGameOnDisk">
                                <label class="form-check-label" for="enableDeleteGameOnDisk" data-toggle="tooltip" title="Enables the option to delete games from disk. When disabled, this option will be hidden from the UI.">
                                    Enable Delete Game on Disk
                                </label>
                            </div>

                            <div class="form-group">
                                <label for="siteUrl" class="form-label" data-toggle="tooltip" title="Specify the base URL for your site (e.g., http://yoursite.com)">
                                    Site URL
                                </label>
                                <input type="url" class="form-control form-control-sm" id="siteUrl" name="siteUrl"
                                    placeholder="http://yoursite.com">
                            </div>
                        </div>
                    </div>

                    <!-- Column 2: Scanning & Performance -->
                    <div class="col-lg-4">
                        <div class="settings-section">
                            <h5 class="section-header">
                                <i class="fas fa-search"></i> Scanning & Performance
                            </h5>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="enableGameUpdates">
                                <label class="form-check-label" for="enableGameUpdates" data-toggle="tooltip" title="Enables scanning for update files/folder in the game's defined subdirectory.">
                                    Enable Game Updates Scanning
                                </label>
                            </div>
                            <div class="form-group mb-3">
                                <input type="text" class="form-control form-control-sm" id="updateFolderName" name="updateFolderName"
                                    placeholder="Updates folder name" data-toggle="tooltip" title="Specify the common name for update subfolders">
                            </div>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="enableGameExtras">
                                <label class="form-check-label" for="enableGameExtras" data-toggle="tooltip" title="Enables scanning for Extra files in the game's defined subdirectory.">
                                    Enable Extra Files Scanning
                                </label>
                            </div>
                            <div class="form-group mb-3">
                                <input type="text" class="form-control form-control-sm" id="extrasFolderName" name="extrasFolderName"
                                    placeholder="Extras folder name" data-toggle="tooltip" title="Specify the common name for extras subfolders">
                            </div>

                            <div class="form-group mb-3">
                                <label for="scanThreadCount" class="form-label" data-toggle="tooltip" title="Number of threads to use for game scanning operations. Higher values = faster scanning but more CPU usage. Recommended for slow internet connections: 1 thread. Recommended for fast connections: 2-4 threads.">
                                    Game Scan Threads
                                </label>
                                <input type="number" class="form-control form-control-sm" id="scanThreadCount" name="scanThreadCount"
                                    min="1" max="4" value="1" placeholder="1">
                                <small class="form-text text-info">Respects IGDB rate limits</small>
                            </div>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="useTurboImageDownloads" checked>
                                <label class="form-check-label" for="useTurboImageDownloads" data-toggle="tooltip" title="ðŸš€ TURBO MODE: Use parallel multi-threaded downloading for game images (8 threads, 200 batch size). When disabled, uses single-thread sequential downloads. TURBO mode is 8-15x faster but uses more bandwidth.">
                                    <i class="fas fa-rocket"></i> Multithreaded Image Downloads
                                </label>
                            </div>

                            <div class="row mb-2">
                                <div class="col-6">
                                    <input type="number" class="form-control form-control-sm" id="turboDownloadThreads" name="turboDownloadThreads"
                                        min="1" max="16" value="8" placeholder="Threads" data-toggle="tooltip" title="Number of simultaneous download threads for TURBO mode">
                                </div>
                                <div class="col-6">
                                    <input type="number" class="form-control form-control-sm" id="turboDownloadBatchSize" name="turboDownloadBatchSize"
                                        min="10" max="500" value="200" placeholder="Batch size" data-toggle="tooltip" title="Number of images to process in each TURBO download batch">
                                </div>
                            </div>

                            <hr class="my-3">
                            <h6 class="text-white mb-2"><i class="fas fa-clock"></i> HowLongToBeat Integration</h6>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="enableHltbIntegration">
                                <label class="form-check-label" for="enableHltbIntegration" data-toggle="tooltip" title="Automatically fetch game completion time estimates from HowLongToBeat.com during game scanning.">
                                    Enable HLTB Integration
                                </label>
                            </div>

                            <div class="form-group mb-3">
                                <label for="hltbRateLimitDelay" class="form-label" data-toggle="tooltip" title="Delay in seconds between HLTB requests to avoid rate limiting (0.5-10 seconds). Default: 2.0">
                                    HLTB Rate Limit Delay (seconds)
                                </label>
                                <input type="number" class="form-control form-control-sm" id="hltbRateLimitDelay" name="hltbRateLimitDelay"
                                    min="0.5" max="10.0" step="0.5" value="2.0" placeholder="2.0">
                            </div>

                            <hr class="my-3">
                            <h6 class="text-white mb-2"><i class="fa-solid fa-file-code"></i> Local Metadata & Images</h6>
                            <small class="text-info d-block mb-2">Jellyfin-style filesystem persistence</small>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="useLocalMetadata">
                                <label class="form-check-label" for="useLocalMetadata" data-toggle="tooltip" title="When enabled, scanner checks for sharewarez.json file in game folders before searching IGDB. This file contains the IGDB ID from previous manual identifications.">
                                    <i class="fa-solid fa-magnifying-glass"></i> Use Local Metadata on Scan
                                </label>
                            </div>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="writeLocalMetadata">
                                <label class="form-check-label" for="writeLocalMetadata" data-toggle="tooltip" title="When enabled, creates sharewarez.json file in game folder after manual identification. This survives database resets and makes future scans faster. Requires write permissions to game folders.">
                                    <i class="fa-solid fa-floppy-disk"></i> Write Metadata File on Manual ID
                                </label>
                            </div>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="useLocalImages">
                                <label class="form-check-label" for="useLocalImages" data-toggle="tooltip" title="When enabled, local images (cover.jpg, screenshot-1.jpg, etc.) in game folders take priority over IGDB-downloaded images. Allows custom artwork per game.">
                                    <i class="fa-solid fa-image"></i> Use Local Images (cover.jpg)
                                </label>
                            </div>

                            <div class="form-group mb-3">
                                <label for="localMetadataFilename" class="form-label" data-toggle="tooltip" title="Filename for local metadata files. Default: sharewarez.json">
                                    <i class="fa-solid fa-file"></i> Metadata Filename
                                </label>
                                <input type="text" class="form-control form-control-sm" id="localMetadataFilename" name="localMetadataFilename"
                                    value="sharewarez.json" placeholder="sharewarez.json">
                                <small class="form-text text-info">Stored in each game folder</small>
                            </div>
                        </div>
                    </div>

                    <!-- Column 3: Interface -->
                    <div class="col-lg-4">
                        <div class="settings-section">
                            <h5 class="section-header">
                                <i class="fa-solid fa-display"></i> Interface
                            </h5>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="showSystemLogo">
                                <label class="form-check-label" for="showSystemLogo" data-toggle="tooltip" title="When enabled, displays the SharewareZ logo on the main interface.">
                                    Show System Logo
                                </label>
                            </div>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="showHelpButton">
                                <label class="form-check-label" for="showHelpButton" data-toggle="tooltip" title="Adds a help button to the interface, providing users with quick access to support resources.">
                                    Show Help Button
                                </label>
                            </div>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="enableWebLinksOnDetailsPage">
                                <label class="form-check-label" for="enableWebLinksOnDetailsPage" data-toggle="tooltip" title="Shows external web links (e.g., official website, community forums) on game detail pages as an icon.">
                                    Show Weblinks on Details Page
                                </label>
                            </div>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="showVersion">
                                <label class="form-check-label" for="showVersion" data-toggle="tooltip" title="Displays the current app version below the app logo.">
                                    Show Version
                                </label>
                            </div>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="showDiscovery">
                                <label class="form-check-label" for="showDiscovery" data-toggle="tooltip" title="Shows the Discover menu item in the sidebar navigation.">
                                    Show Discovery
                                </label>
                            </div>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="showFavorites">
                                <label class="form-check-label" for="showFavorites" data-toggle="tooltip" title="Shows the Favorites menu item in the sidebar navigation.">
                                    Show Favorites
                                </label>
                            </div>

                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="showTrailers">
                                <label class="form-check-label" for="showTrailers" data-toggle="tooltip" title="Shows the Trailers menu item in the sidebar navigation.">
                                    Show Trailers
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
   
<!-- Embed current_settings as JSON in a script tag -->
<script id="currentSettings" type="application/json">{{ current_settings|tojson }}</script>
<script id="csrf_token" type="application/json">{{ csrf_token() }}</script>

<script src="{{ 'js/admin_manage_server_settings.js'|theme_asset }}"></script>

{% endblock %}
